version: 1.0.0.{build}
os: Visual Studio 2019

environment:
  nodejs_version: "10.3.0"
  ASPNETCORE_ENVIRONMENT: appveyor

configuration: Release

services:
  - mssql2016

init:
  - git config --global core.autocrlf true

install:
  - ps: Install-Product node $env:nodejs_version

build_script:
  - ps: ./build.ps1

test: off

artifacts:
  - path: 'build\*.zip'
    name: Archive
  - path: 'build\InstructorIQ.Website.*.zip'
    name: Website
  - path: 'build\*.nupkg'
    name: Deploy
  - path: 'build\database\*.dacpac'
    name: Database

after_deploy:
  - cmd: dotnet test service\test\InstructorIQ.Core.Tests\InstructorIQ.Core.Tests.csproj